# 智能跌倒检测Web系统

基于AI的智能跌倒检测Web系统，融合YOLO姿态检测和LLaMA大语言模型，提供隐私友好的居家安全监护解决方案。

## 🌟 主要特性

### 🤖 智能检测技术
- **YOLO姿态检测**: 高精度人体关键点检测
- **双重跌倒识别**: 突发性跌倒 + 持续性跌倒检测
- **实时处理**: 本地边缘计算，无需上传原始视频

### 🧠 AI智能分析
- **LLaMA模型集成**: 生成个性化关怀建议
- **风险等级评估**: 低/中/高三级风险分类
- **语义化反馈**: 自然语言的分析报告

### 📊 数据可视化
- **实时图表**: 检测置信度、事件时间线
- **交互式分析**: 可点击的数据面板
- **统计报告**: 完整的检测结果分析

### 🔒 隐私保护
- **本地处理**: 所有计算在本地完成
- **无数据库**: 不存储个人隐私信息
- **结构化输出**: 仅保存分析结果

## 🏗️ 系统架构

```
智能跌倒检测Web系统
├── 前端界面 (HTML5 + Bootstrap + Chart.js)
│   ├── 视频上传模块
│   ├── 实时进度监控
│   ├── 数据可视化面板
│   └── 结果分析页面
├── 后端服务 (Flask)
│   ├── 文件上传处理
│   ├── 异步任务管理
│   ├── 检测结果分析
│   └── API接口服务
└── AI检测引擎
    ├── YOLO模型 (跌倒检测 + 姿态检测)
    ├── LLaMA模型 (智能分析)
    └── 结果分析器
```

## 🚀 快速开始

### 环境要求
- Python 3.8+
- 至少4GB RAM
- 支持CUDA的GPU（可选，用于加速）

### 安装步骤

1. **克隆项目**
```bash
cd Smart-Fall-Detection-Demo/web_fall_detection
```

2. **安装依赖**
```bash
pip install -r requirements.txt
```

3. **模型文件准备**
确保以下模型文件存在：
```
../models/
├── best.pt                    # YOLO跌倒检测模型
├── yolov8n-pose.pt           # YOLO姿态检测模型
└── tinyllama-1.1b-chat-v1.0.Q4_K_M.gguf  # LLaMA模型
```

4. **启动系统**
```bash
python app.py
```

5. **访问系统**
打开浏览器访问: `http://localhost:5000`

## 📖 使用指南

### 1. 视频上传
- 支持格式：MP4、AVI、MOV
- 文件大小：最大500MB
- 拖拽或点击上传

### 2. 参数配置
- **置信度阈值**: 控制检测敏感度 (0.1-0.9)
- **IOU阈值**: 控制重叠检测过滤 (0.1-0.9)

### 3. 检测过程
- 实时进度显示
- 自动状态更新
- 错误处理与重试

### 4. 结果分析
- 跌倒事件统计
- 风险等级评估
- AI智能建议
- 数据可视化图表

## 🔧 API接口

### 上传视频
```
POST /upload
Content-Type: multipart/form-data
Body: video file
```

### 开始检测
```
POST /detect/{task_id}
Content-Type: application/json
Body: {"confidence": 0.5, "iou_threshold": 0.4}
```

### 查询状态
```
GET /status/{task_id}
```

### 获取结果
```
GET /result/{task_id}
```

### 下载视频
```
GET /download/{task_id}
```

## 📊 检测结果结构

```json
{
  "video_info": {
    "width": 1920,
    "height": 1080,
    "fps": 30,
    "total_frames": 3600,
    "duration": 120.0
  },
  "fall_events": [
    {
      "frame": 1500,
      "timestamp": 50.0,
      "type": "sudden",
      "confidence": 0.85,
      "bbox": [100, 200, 300, 400],
      "center": [200, 300]
    }
  ],
  "analysis": {
    "summary": {
      "total_falls": 2,
      "risk_level": "medium",
      "video_duration": 120.0,
      "processing_time": 45.2
    },
    "recommendations": [
      "⚠️ 检测到中等风险，需要关注",
      "👥 建议家属或护理人员定期检查"
    ]
  },
  "llm_analysis": "基于检测结果的智能分析..."
}
```

## 🎯 技术亮点

### 1. 高精度检测
- **双重检测机制**: 结合突发性和持续性跌倒识别
- **姿态关键点**: 17个关键点精确追踪
- **时序分析**: 滑动窗口投票机制

### 2. 智能分析
- **风险评估**: 基于事件频次和置信度的多维评估
- **个性化建议**: LLaMA模型生成的自然语言反馈
- **趋势分析**: 时间分布和模式识别

### 3. 用户体验
- **响应式设计**: 支持桌面和移动设备
- **实时反馈**: WebSocket实时进度更新
- **直观可视化**: Chart.js交互式图表

## 🛡️ 安全特性

- **本地计算**: 视频不上传云端
- **隐私保护**: 仅保存分析结果
- **数据清理**: 自动清理临时文件
- **错误处理**: 完善的异常处理机制

## 📈 性能优化

- **异步处理**: 后台任务队列
- **内存管理**: 大文件分块处理
- **模型优化**: 轻量化YOLO模型
- **缓存机制**: 智能结果缓存

## 🔮 未来规划

- [ ] 批量视频处理
- [ ] 实时摄像头监控
- [ ] 移动端APP
- [ ] 云端部署版本
- [ ] 多语言支持
- [ ] 高级数据分析

## 🤝 贡献指南

欢迎提交Issue和Pull Request！

## 📄 许可证

MIT License

## 📞 支持与反馈

如有问题或建议，请通过以下方式联系：
- 提交GitHub Issue
- 发送邮件反馈

---

**智能跌倒检测Web系统** - 守护长者安全，AI赋能关怀 💖
